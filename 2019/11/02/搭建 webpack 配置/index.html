<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>搭建 webpack 配置 - LeeChar</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    
    <meta name="description" content="1.什么是Webpack？webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler),当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle">
<meta name="keywords" content="webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="搭建 webpack 配置">
<meta property="og:url" content="http://leechar.github.io/2019/11/02/搭建 webpack 配置/index.html">
<meta property="og:site_name" content="LeeChar">
<meta property="og:description" content="1.什么是Webpack？webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler),当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2019/jpeg/283097/1568701889785-4273ad7b-70f1-40bd-ac4a-44db3dcb58eb.jpeg#align=left&display=inline&height=362&originHeight=362&originWidth=779&size=0&status=done&width=779">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2019/png/283097/1568701889662-085bdeb5-c41a-4015-a084-f7d71a842261.png#align=left&display=inline&height=394&originHeight=394&originWidth=1047&size=0&status=done&width=1047">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2019/png/283097/1568701889609-6f39304f-4c9a-4ab6-b046-ec88995a31e7.png#align=left&display=inline&height=279&originHeight=279&originWidth=805&size=0&status=done&width=805">
<meta property="og:updated_time" content="2019-11-02T20:57:01.288Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="搭建 webpack 配置">
<meta name="twitter:description" content="1.什么是Webpack？webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler),当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2019/jpeg/283097/1568701889785-4273ad7b-70f1-40bd-ac4a-44db3dcb58eb.jpeg#align=left&display=inline&height=362&originHeight=362&originWidth=779&size=0&status=done&width=779">








<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/solarized-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<!--<body class="is-2-column">-->
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
                <!-- <img src="/images/maotouying.svg" alt="蜗居年华" height="28"> -->
                <!-- <img src="/images/maotouying.svg" alt="搭建 webpack 配置" height="28"> -->
                <!-- <span style="font-size: 16px; display: inline-block; vertical-align: top; font-weight: 600;">云卷云舒</span> -->
                <!--
            % if (has_config('logo.text') && get_config('logo.text')) { 
                <span style="font-size: 16px; display: inline-block; vertical-align: top; font-weight: 600;">%= get_config('logo.text') %</span>
                %= get_config('logo.text') %
            % } else { %
                <img src="%- url_for(get_config('logo')) %" alt="%= get_config('title') %" height="28">
            % } %
                -->
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">首页</a>
                
                <a class="navbar-item" href="/archives">归档</a>
                
                <a class="navbar-item" href="/categories">分类</a>
                
                <a class="navbar-item" href="/tags">标签</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="文章目录" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">



                    <i class="fas fa-search"></i>

                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">    <div class="card">

        <!--update by thank: 文章详情页面不显示文章图片thumbnail-->
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">

                <!--updated by thank: 列表页显示几年前, 文章页显示具体日期-->
                
                <span style="color: #7a7a7a !important;">写于2019-11-02 19:30:04&nbsp;&nbsp;&nbsp;</span>
                

                <!--<span style="color: #7a7a7a !important;">2019-11-02 19:30:04&nbsp;&nbsp;&nbsp;</span>-->
                <!--<time class="level-item has-text-grey" datetime="2019-11-02T11:30:04.000Z">2019-11-02</time>-->
                <!--<time class="level-item has-text-grey"  datetime="2019-12-12 22:22:22">2018-12-12 22:22:22</time>-->

                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/程序员/">程序员</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    26 分钟 读完 (大约 3872 个字)
                </span>
                

                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span>次访问
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                搭建 webpack 配置
            
        </h1>

        <div class="content">

            <!--update by thank: 控制首页摘要信息不显示样式(去掉Markdown生成的html标签)-->
            
                <h2 id="1-什么是Webpack？"><a href="#1-什么是Webpack？" class="headerlink" title="1.什么是Webpack？"></a>1.什么是Webpack？</h2><p>webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler),当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/283097/1568701889785-4273ad7b-70f1-40bd-ac4a-44db3dcb58eb.jpeg#align=left&amp;display=inline&amp;height=362&amp;originHeight=362&amp;originWidth=779&amp;size=0&amp;status=done&amp;width=779" alt></p>
<a id="more"></a>
<p>使用Webpack作为前端构建工具：</p>
<ul>
<li>代码转换：TypeScript 编译成 JavaScript、SCSS 编译成 CSS 等。</li>
<li>文件优化：压缩 JavaScript、CSS、HTML 代码，压缩合并图片等。</li>
<li>代码分割：提取多个页面的公共代码、提取首屏不需要执行部分的代码让其异步加载。</li>
<li>模块合并：在采用模块化的项目里会有很多个模块和文件，需要构建功能把模块分类合并成一个文件。</li>
<li>自动刷新：监听本地源代码的变化，自动重新构建、刷新浏览器。</li>
<li>代码校验：在代码被提交到仓库前需要校验代码是否符合规范，以及单元测试是否通过。</li>
<li>自动发布：更新完代码后，自动构建出线上发布代码并传输给发布系统。</li>
</ul>
<p><strong>在<code>webpack</code>应用中有两个核心</strong>:</p>
<ul>
<li><ol>
<li>模块转换器，用于把模块原内容按照需求转换成新内容，可以加载非 JS 模块</li>
</ol>
</li>
<li><ol>
<li>扩展插件，在 Webpack 构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li>
</ol>
</li>
</ul>
<h2 id="2-初始化项目"><a href="#2-初始化项目" class="headerlink" title="2.初始化项目"></a>2.初始化项目</h2><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">├── src   <span class="hljs-comment"># 源码目录</span></span><br><span class="line">│   ├── a-module.js</span><br><span class="line">│   └── index.js</span><br></pre></td></tr></table></figure>
<p>编写 <em>a-module.js</em></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-string">'hello'</span>;</span><br></pre></td></tr></table></figure>
<p>编写 <em>index.js</em></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./a-module'</span>);</span><br><span class="line"><span class="hljs-built_in">console</span>.log(a);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里我们使用<code>CommonJS</code>模块的方式引入，这种方式默认在浏览器上是无法运行的，我们希望通过 <code>webpack</code> 来进行打包！</p>
</blockquote>
<h2 id="3-webpack快速上手"><a href="#3-webpack快速上手" class="headerlink" title="3.webpack快速上手"></a>3.webpack快速上手</h2><h3 id="3-1-安装"><a href="#3-1-安装" class="headerlink" title="3.1 安装"></a>3.1 安装</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install webpack webpack-cli --save-dev</span><br></pre></td></tr></table></figure>
<p><code>webpack</code>默认支持0配置,配置<code>scripts</code>脚本</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "build": "webpack"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行<code>npm run build</code>,默认会调用 <code>node_modules/.bin</code>下的<code>webpack</code>命令，内部会调用<code>webpack-cli</code>解析用户参数进行打包。默认会以 <code>src/index.js</code> 作为入口文件。</p>
<blockquote>
<p>这里也可以使用<code>npx webpack</code>,<code>npx</code> 是 5.2版本之后<code>npm</code>提供的命令可以执行<code>.bin</code>下的可执行文件</p>
</blockquote>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/283097/1568701889662-085bdeb5-c41a-4015-a084-f7d71a842261.png#align=left&amp;display=inline&amp;height=394&amp;originHeight=394&amp;originWidth=1047&amp;size=0&amp;status=done&amp;width=1047" alt></p>
<p>我们可以发现已经产生了<code>dist</code>目录，此目录为最终打包出的结果。<code>main.js</code>可以在html中直接引用,这里还提示我们默认<code>mode</code> 为<code>production</code></p>
<h3 id="3-2-webpack-config-js"><a href="#3-2-webpack-config-js" class="headerlink" title="3.2 webpack.config.js"></a>3.2 webpack.config.js</h3><p>我们打包时一般不会采用0配置，<code>webpack</code>在打包时默认会查找当前目录下的 <code>webpack.config.js or webpackfile.js</code> 文件。</p>
<p>通过配置文件进行打包</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);</span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="hljs-string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename:<span class="hljs-string">'bundle.js'</span>, <span class="hljs-comment">// 打包出的结果文件</span></span><br><span class="line">        path:path.resolve(__dirname,<span class="hljs-string">'dist'</span>) <span class="hljs-comment">// 打包到dist目录下</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-配置打包的mode"><a href="#3-3-配置打包的mode" class="headerlink" title="3.3 配置打包的mode"></a>3.3 配置打包的mode</h3><p>我们需要在打包时提供<code>mode</code>属性来区分是开发环境还是生产环境,来实现配置文件的拆分</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">├── build</span><br><span class="line">│   ├── webpack.base.js</span><br><span class="line">│   ├── webpack.dev.js</span><br><span class="line">│   └── webpack.prod.js</span><br></pre></td></tr></table></figure>
<p><strong>我们可以通过指定不同的文件来进行打包</strong></p>
<p>配置<code>scripts</code>脚本</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">  "build": "webpack --config ./build/webpack.prod",</span><br><span class="line">  "dev": "webpack --config ./build/webpack.dev"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以通过 <code>config</code> 参数指定,使用哪个配置文件来进行打包</p>
<p><strong>通过env参数区分</strong></p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "build": "webpack --env.production --config ./build/webpack.base",</span><br><span class="line">    "dev": "webpack --env.development --config ./build/webpack.base"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改造<code>webpack.base</code>文件默认导出函数，会将环境变量传入到函数的参数中</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">env</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="hljs-built_in">console</span>.log(env); <span class="hljs-comment">// &#123; development: true &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>合并配置文件</strong></p>
<p>我们可以判断当前环境是否是开发环境来加载不同的配置,这里我们需要做配置合并<br>安装<code>webpack-merge</code>:</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-merge --save-dev</span><br></pre></td></tr></table></figure>
<p><code>webpack.dev</code>配置</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="hljs-string">'development'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>webpack.prod</code>配置</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="hljs-string">'production'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>webpack.base</code>配置</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>);</span><br><span class="line"><span class="hljs-comment">// 开发环境</span></span><br><span class="line"><span class="hljs-keyword">const</span> dev = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.dev'</span>);</span><br><span class="line"><span class="hljs-comment">// 生产环境</span></span><br><span class="line"><span class="hljs-keyword">const</span> prod = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.prod'</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">const</span> base = &#123; <span class="hljs-comment">// 基础配置</span></span><br><span class="line">    entry:<span class="hljs-string">'./src/index.js'</span>,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:<span class="hljs-string">'bundle.js'</span>,</span><br><span class="line">        path:path.resolve(__dirname,<span class="hljs-string">'../dist'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">env</span>) =&gt;</span>&#123;</span><br><span class="line">    <span class="hljs-keyword">if</span>(env.development)&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> merge(base,dev);</span><br><span class="line">    &#125;<span class="hljs-keyword">else</span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> merge(base,prod)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>后续的开发中，我们会将公共的逻辑放到<code>base</code>中,开发和生产对的配置也分别进行存放！</p>
<h2 id="4-webpack-dev-server"><a href="#4-webpack-dev-server" class="headerlink" title="4.webpack-dev-server"></a>4.webpack-dev-server</h2><p>配置开发服务器，可以在实现在内存中打包,并且自动启动服务</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-dev-server --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "build": "webpack --env.production --config ./build/webpack.base",</span><br><span class="line">    "dev": "webpack-dev-server --env.development --config ./build/webpack.base"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过执行<code>npm run dev</code>来启启动开发环境</p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/283097/1568701889609-6f39304f-4c9a-4ab6-b046-ec88995a31e7.png#align=left&amp;display=inline&amp;height=279&amp;originHeight=279&amp;originWidth=805&amp;size=0&amp;status=done&amp;width=805" alt></p>
<p>默认会在当前根目录下启动服务</p>
<p><strong>配置开发服务的配置</strong></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)</span><br><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="hljs-string">'development'</span>,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        <span class="hljs-comment">// 更改静态文件目录位置</span></span><br><span class="line">        contentBase:path.resolve(__dirname,<span class="hljs-string">'../dist'</span>),</span><br><span class="line">        compress:<span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启gzip</span></span><br><span class="line">        port:<span class="hljs-number">3000</span>, <span class="hljs-comment">// 更改端口号</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-打包Html插件"><a href="#5-打包Html插件" class="headerlink" title="5.打包Html插件"></a>5.打包Html插件</h2><h3 id="5-1-单入口打包"><a href="#5-1-单入口打包" class="headerlink" title="5.1 单入口打包"></a>5.1 单入口打包</h3><p>自动产生html，并引入打包后的文件</p>
<p>编辑<code>webpack.base</code>文件</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);</span><br><span class="line">plugins:[</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        filename:<span class="hljs-string">'index.html'</span>, <span class="hljs-comment">// 打包出来的文件名</span></span><br><span class="line">        template:path.resolve(__dirname,<span class="hljs-string">'../public/index.html'</span>),</span><br><span class="line">        hash:<span class="hljs-literal">true</span>, <span class="hljs-comment">// 在引用资源的后面增加hash戳</span></span><br><span class="line">        minify:&#123;</span><br><span class="line">            removeAttributeQuotes:<span class="hljs-literal">true</span> <span class="hljs-comment">// 删除属性双引号</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="5-2-多入口打包"><a href="#5-2-多入口打包" class="headerlink" title="5.2 多入口打包"></a>5.2 多入口打包</h3><p>根据不同入口 生成多个js文件，引入到不同html中</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">── src</span><br><span class="line">    ├── entry-1.js</span><br><span class="line">    └── entry-2.js</span><br></pre></td></tr></table></figure>
<p>多入口需要配置多个entry</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">entry:&#123;</span><br><span class="line">    jquery:[<span class="hljs-string">'jquery'</span>], <span class="hljs-comment">// 打包jquery</span></span><br><span class="line">    entry1:path.resolve(__dirname,<span class="hljs-string">'../src/entry-1.js'</span>),</span><br><span class="line">    entry2:path.resolve(__dirname,<span class="hljs-string">'../src/entry-2.js'</span>)</span><br><span class="line">&#125;,</span><br><span class="line">output:&#123;</span><br><span class="line">    filename:<span class="hljs-string">'[name].js'</span>,</span><br><span class="line">    path:path.resolve(__dirname,<span class="hljs-string">'../dist'</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>产生多个Html文件</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">    filename:<span class="hljs-string">'index.html'</span>, </span><br><span class="line">    template:path.resolve(__dirname,<span class="hljs-string">'../public/template.html'</span>),</span><br><span class="line">    hash:<span class="hljs-literal">true</span>, </span><br><span class="line">    minify:&#123;</span><br><span class="line">        removeAttributeQuotes:<span class="hljs-literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    chunks:[<span class="hljs-string">'jquery'</span>,<span class="hljs-string">'entry1'</span>], <span class="hljs-comment">// 引入的chunk 有jquery,entry</span></span><br><span class="line">&#125;),</span><br><span class="line"><span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">    filename:<span class="hljs-string">'login.html'</span>,</span><br><span class="line">    template:path.resolve(__dirname,<span class="hljs-string">'../public/template.html'</span>),</span><br><span class="line">    hash:<span class="hljs-literal">true</span>,</span><br><span class="line">    minify:&#123;</span><br><span class="line">        removeAttributeQuotes:<span class="hljs-literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    inject:<span class="hljs-literal">false</span>, <span class="hljs-comment">// inject 为false表示不注入js文件</span></span><br><span class="line">    <span class="hljs-comment">// 默认打包后引入文件的顺序，是根据入口的顺序来的。可以在这里设置 chunksSortMode，指定顺序为 chunks 里的顺序来 </span></span><br><span class="line">    chunksSortMode:<span class="hljs-string">'manual'</span>, </span><br><span class="line">    chunks:[<span class="hljs-string">'entry2'</span>,<span class="hljs-string">'jquery'</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>以上的方式不是很优雅，每次都需要手动添加<code>HtmlPlugin</code>应该动态产生<code>html</code>文件，可以像这样优化:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">let</span> htmlPlugins = [</span><br><span class="line">  &#123;</span><br><span class="line">    entry: <span class="hljs-string">"entry1"</span>,</span><br><span class="line">    html: <span class="hljs-string">"index.html"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    entry: <span class="hljs-string">"entry2"</span>,</span><br><span class="line">    html: <span class="hljs-string">"login.html"</span></span><br><span class="line">  &#125;</span><br><span class="line">].map(</span><br><span class="line">  item =&gt;</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: item.html,</span><br><span class="line">      template: path.resolve(__dirname, <span class="hljs-string">"../public/template.html"</span>),</span><br><span class="line">      hash: <span class="hljs-literal">true</span>,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        removeAttributeQuotes: <span class="hljs-literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      chunks: [<span class="hljs-string">"jquery"</span>, item.entry]</span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">plugins: [...htmlPlugins]</span><br></pre></td></tr></table></figure>
<h2 id="6-清空打包结果"><a href="#6-清空打包结果" class="headerlink" title="6.清空打包结果"></a>6.清空打包结果</h2><p>可以使用<code>clean-webpack-plugin</code>手动清除某个文件夹内容:</p>
<p><strong>安装</strong></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev clean-webpack-plugin</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="hljs-keyword">new</span> CleanWebpackPlugin(&#123;</span><br><span class="line">    <span class="hljs-comment">// 清空匹配的路径</span></span><br><span class="line">    cleanOnceBeforeBuildPatterns: [path.resolve(<span class="hljs-string">'xxxx/*'</span>),<span class="hljs-string">'**/*'</span>],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>这样就可以清空指定的目录了,我们可以看到<code>webpack</code>插件的基本用法就是 <code>new Plugin</code>并且放到<code>plugins</code>中</p>
<h1 id="Webpack中必须掌握的配置"><a href="#Webpack中必须掌握的配置" class="headerlink" title="Webpack中必须掌握的配置"></a>Webpack中必须掌握的配置</h1><p>loader主要用于把模块原内容按照需求转换成新内容，可以加载非 JS 模块！<br>通过使用不同的Loader，Webpack可以把不同的文件都转成JS文件,比如CSS、ES6/7、JSX等。</p>
<p>我们来看看这些我们必须掌握的loader!</p>
<h2 id="1-配置-loader"><a href="#1-配置-loader" class="headerlink" title="1.配置 loader"></a>1.配置 loader</h2><h3 id="1-1-loader的使用"><a href="#1-1-loader的使用" class="headerlink" title="1.1 loader的使用"></a>1.1 loader的使用</h3><ul>
<li>test：匹配处理文件的扩展名的正则表达式</li>
<li>use：loader名称，就是你要使用模块的名称</li>
<li>include/exclude:手动指定必须处理的文件夹或屏蔽不需要处理的文件夹</li>
<li>options:为loaders提供额外的设置选项</li>
</ul>
<p>默认<code>loader</code>的顺序是<strong>从下到上</strong>、<strong>从右向左</strong>执行，当然执行顺序也可以手动定义的，接下来我们依次介绍常见的loader，来感受<code>loader</code>的魅力!</p>
<p>我们基于这个基础配置来继续编写:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> dev = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./webpack.dev"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> prod = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./webpack.prod"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack-merge"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"html-webpack-plugin"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> base = &#123;</span><br><span class="line">  entry:<span class="hljs-string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="hljs-string">"[name].js"</span>,</span><br><span class="line">    path: path.resolve(__dirname, <span class="hljs-string">"../dist"</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">        filename: <span class="hljs-string">'index.html'</span>,</span><br><span class="line">        template: path.resolve(__dirname, <span class="hljs-string">"../public/template.html"</span>),</span><br><span class="line">        hash: <span class="hljs-literal">true</span>,</span><br><span class="line">        minify: &#123;</span><br><span class="line">            removeAttributeQuotes: <span class="hljs-literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="hljs-keyword">new</span> CleanWebpackPlugin(&#123;</span><br><span class="line">        cleanOnceBeforeBuildPatterns: [path.resolve(<span class="hljs-string">'xxxx/*'</span>),<span class="hljs-string">'**/*'</span>],</span><br><span class="line">    &#125;),</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">env</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">if</span> (env.development) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, dev);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, prod);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="2-处理CSS文件"><a href="#2-处理CSS文件" class="headerlink" title="2.处理CSS文件"></a>2.处理CSS文件</h2><h3 id="2-1-解析css样式"><a href="#2-1-解析css样式" class="headerlink" title="2.1 解析css样式"></a>2.1 解析css样式</h3><p>我们在<code>js</code>文件中引入css样式！</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> <span class="hljs-string">'./index.css'</span>;</span><br></pre></td></tr></table></figure>
<p>再次执行打包时，会提示css无法解析</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="hljs-keyword">in</span> ./src/index.css 1:4</span><br><span class="line">Module parse failed: Unexpected token (1:4)</span><br><span class="line">You may need an appropriate loader to handle this file <span class="hljs-built_in">type</span>, currently no loaders are configured to process this file. See https://webpack.js.org/concepts<span class="hljs-comment">#loaders</span></span><br></pre></td></tr></table></figure>
<p><strong>安装loader</strong></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install style-loader css-loader --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">    &#123;</span><br><span class="line">       test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">       use: [<span class="hljs-string">"style-loader"</span>, <span class="hljs-string">"css-loader"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-抽离样式文件"><a href="#2-2-抽离样式文件" class="headerlink" title="2.2 抽离样式文件"></a>2.2 抽离样式文件</h3><p>默认只在打包时进行样式抽离</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">env</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> isDev = env.development;</span><br><span class="line">  <span class="hljs-keyword">const</span> base = &#123;<span class="hljs-comment">/*source...*/</span>&#125;</span><br><span class="line">  <span class="hljs-keyword">if</span> (isDev) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, dev);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, prod);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>安装抽离插件</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mini-css-extract-plugin --save-dev</span><br></pre></td></tr></table></figure>
<p>配置抽离插件</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">                    isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">                    <span class="hljs-string">"css-loader"</span></span><br><span class="line">                ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">         !isDev &amp;&amp; <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="hljs-string">"css/[name].css"</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>plugins</code> 里的成员，不能是一个布尔值，否则会报错；而上面的配置在开发环境下会是个 <code>false</code> 。那么我们就可以通过数组的 <code>filter</code>  方法做个简单的过滤处理。</p>
</blockquote>
<p>最终文件配置:</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> dev = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./webpack.dev"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> prod = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./webpack.prod"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack-merge"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> MiniCssExtractPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"html-webpack-plugin"</span>);</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">env</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">let</span> isDev = env.development;</span><br><span class="line">  <span class="hljs-keyword">const</span> base = &#123;</span><br><span class="line">    entry: <span class="hljs-string">"./src/index.js"</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">      filename: <span class="hljs-string">"[name].js"</span>,</span><br><span class="line">      path: path.resolve(__dirname, <span class="hljs-string">"../dist"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">      rules: [</span><br><span class="line">        &#123;</span><br><span class="line">          test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">          use: [</span><br><span class="line">            !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">            isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">            <span class="hljs-string">"css-loader"</span></span><br><span class="line">          ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:[</span><br><span class="line">        !isDev &amp;&amp; <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">          filename: <span class="hljs-string">"css/[name].css"</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="hljs-keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">          filename: <span class="hljs-string">"index.html"</span>,</span><br><span class="line">          template: path.resolve(__dirname, <span class="hljs-string">"../public/template.html"</span>),</span><br><span class="line">          hash: <span class="hljs-literal">true</span>,</span><br><span class="line">          minify: &#123;</span><br><span class="line">            removeAttributeQuotes: <span class="hljs-literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">      ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="hljs-keyword">if</span> (isDev) &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, dev);</span><br><span class="line">  &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="line">    <span class="hljs-keyword">return</span> merge(base, prod);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-css预处理器"><a href="#2-3-css预处理器" class="headerlink" title="2.3 css预处理器"></a>2.3 css预处理器</h3><p>不同的css预处理器要安装不同的loader来进行解析</p>
<table>
<thead>
<tr>
<th><strong>预处理器</strong></th>
<th><strong>需要的 loader</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sass</td>
<td>sass-loader、node-sass</td>
</tr>
<tr>
<td>less</td>
<td>less-loader、less</td>
</tr>
<tr>
<td>stylus</td>
<td>stylus-loader、stylus</td>
</tr>
</tbody>
</table>
<p>使用<code>sass</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="hljs-regexp">/\.scss$/</span>,</span><br><span class="line">    use:[</span><br><span class="line">        !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">        isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">        <span class="hljs-string">"css-loader"</span>,</span><br><span class="line">        <span class="hljs-string">"sass-loader"</span></span><br><span class="line">    ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在css文件中可能会使用<code>@import</code>语法引用<code>css</code>文件,被引用的<code>css</code>文件中可能还会导入 <code>scss</code> 。这样在编译 <code>css</code><br>的时候，scss 代码不会被编译；可以这么配置：<br><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">    !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">    isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        loader:<span class="hljs-string">"css-loader"</span>,</span><br><span class="line">        options:&#123;</span><br><span class="line">            importLoaders: <span class="hljs-number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-string">"sass-loader"</span></span><br><span class="line">    ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>把 <code>css-loader</code> 的用法改成对象，在配置里面设置 <code>importLoaders</code> 。表示在使用 <code>css-loader</code> 编译之前，如果 <code>css</code> 里面使用了 <code>@import</code> 语法引入了一个 <code>scss</code> 文件，就先用 <strong>1</strong> 个放置在在后面的 <code>loader</code> 先编译一次；也就用 <code>sass-loader</code> 编译一次。再继续用 <code>css-loader</code> 编译，就会编译引入的那个 <code>scss</code>。</p>
</blockquote>
<h3 id="2-4-处理样式前缀"><a href="#2-4-处理样式前缀" class="headerlink" title="2.4 处理样式前缀"></a>2.4 处理样式前缀</h3><p>使用<code>postcss-loader</code>增加样式前缀</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install postcss-loader autoprefixer</span><br></pre></td></tr></table></figure>
<p>在处理css前先增加前缀</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">    !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">    isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">        loader:<span class="hljs-string">"postcss-loader"</span>,</span><br><span class="line">        options:&#123;</span><br><span class="line">            plugins:[<span class="hljs-built_in">require</span>(<span class="hljs-string">'autoprefixer'</span>)]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="hljs-string">"sass-loader"</span></span><br><span class="line">    ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者也可以创建<code>postcss</code>的配置文件<code>postcss.config.js</code></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins:[</span><br><span class="line">        <span class="hljs-built_in">require</span>(<span class="hljs-string">'autoprefixer'</span>)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="hljs-regexp">/\.css$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">    !isDev &amp;&amp; MiniCssExtractPlugin.loader,</span><br><span class="line">    isDev &amp;&amp; <span class="hljs-string">'style-loader'</span>,</span><br><span class="line">    <span class="hljs-string">"postcss-loader"</span>,</span><br><span class="line">    <span class="hljs-string">"sass-loader"</span></span><br><span class="line">    ].filter(<span class="hljs-built_in">Boolean</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以配置浏览器的兼容性范围，在项目根目录下建一个 <a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener">.browserslistrc</a> 文件：</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cover <span class="hljs-number">99.5</span>%</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里表示覆盖的浏览器范围</p>
</blockquote>
<h3 id="2-5-css压缩"><a href="#2-5-css压缩" class="headerlink" title="2.5 css压缩"></a>2.5 css压缩</h3><p>在生产环境下我们需要压缩<code>css</code>文件,配置<code>minimizer</code>选项,安装压缩插件</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i optimize-css-assets-webpack-plugin terser-webpack-plugin --save-dev</span><br></pre></td></tr></table></figure>
<p>在<code>webpack.prod.js</code>文件中配置压缩</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> OptimizeCSSAssetsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'optimize-css-assets-webpack-plugin'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> TerserJSPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'terser-webpack-plugin'</span>);</span><br><span class="line">optimization:&#123;</span><br><span class="line">    minimizer:[<span class="hljs-keyword">new</span> TerserJSPlugin(&#123;&#125;), <span class="hljs-keyword">new</span> OptimizeCSSAssetsPlugin(&#123;&#125;)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-6-文件指纹"><a href="#2-6-文件指纹" class="headerlink" title="2.6 文件指纹"></a>2.6 文件指纹</h3><ul>
<li>Hash整个项目的hash值</li>
<li>chunkhash 根据入口产生hash值</li>
<li>contentHash 根据每个文件的内容产生的hash值</li>
</ul>
<p>我们可以合理的使用<code>hash</code>戳，进行文件的缓存</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">!isDev &amp;&amp; <span class="hljs-keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    filename: <span class="hljs-string">"css/[name].[contentHash].css"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="3-处理文件类型"><a href="#3-处理文件类型" class="headerlink" title="3.处理文件类型"></a>3.处理文件类型</h2><h3 id="3-1-处理引用的图片"><a href="#3-1-处理引用的图片" class="headerlink" title="3.1 处理引用的图片"></a>3.1 处理引用的图片</h3><figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> logo <span class="hljs-keyword">from</span> <span class="hljs-string">'./webpack.png'</span>;</span><br><span class="line"><span class="hljs-keyword">let</span> img = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>);</span><br><span class="line">img.src = logo;</span><br><span class="line"><span class="hljs-built_in">document</span>.body.appendChild(img);</span><br></pre></td></tr></table></figure>
<p>使用<code>file-loader</code>,会将图片进行打包，并将打包后的路径返回</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="hljs-regexp">/\.jpe?g|png|gif/</span>,</span><br><span class="line">    use:&#123;</span><br><span class="line">        loader:<span class="hljs-string">'file-loader'</span>,</span><br><span class="line">        options:&#123;</span><br><span class="line">            name:<span class="hljs-string">`img/[name].[ext]`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-2-处理icon"><a href="#3-2-处理icon" class="headerlink" title="3.2 处理icon"></a>3.2 处理icon</h3><p>二进制文件也是使用<code>file-loader</code>来打包</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="hljs-regexp">/woff|ttf|eot|svg|otf/</span>,</span><br><span class="line">    use:&#123;</span><br><span class="line">        loader:<span class="hljs-string">'file-loader'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-转化成base64"><a href="#3-3-转化成base64" class="headerlink" title="3.3 转化成base64"></a>3.3 转化成base64</h3><p>使用<code>url-loader</code>将满足条件的图片转化成base64,不满足条件的<code>url-loader</code>会自动调用<code>file-loader</code>来进行处理</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:<span class="hljs-regexp">/\.jpe?g|png|gif/</span>,</span><br><span class="line">    use:&#123;</span><br><span class="line">        loader:<span class="hljs-string">'url-loader'</span>,</span><br><span class="line">        options:&#123;</span><br><span class="line">            limit:<span class="hljs-number">100</span>*<span class="hljs-number">1024</span>,</span><br><span class="line">            name:<span class="hljs-string">`img/[name].[ext]`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-处理JS模块"><a href="#4-处理JS模块" class="headerlink" title="4.处理JS模块"></a>4.处理JS模块</h2><h3 id="4-1-将es6代码编译成es5代码"><a href="#4-1-将es6代码编译成es5代码" class="headerlink" title="4.1 将es6代码编译成es5代码"></a>4.1 将<code>es6</code>代码编译成<code>es5</code>代码</h3><p>代码的转化工作要交给<code>babel</code>来处理</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @babel/core @babel/preset-env babel-loader --save-dev</span><br></pre></td></tr></table></figure>
<p><code>@babel/core</code>是babel中的核心模块，<code>@babel/preset-env</code> 的作用是es6转化es5插件的插件集合，<code>babel-loader</code>是<code>webpack</code>和<code>loader</code>的桥梁。</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> sum = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="hljs-keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>增加<code>babel</code>的配置文件 <code>.babelrc</code></p>
<figure class="highlight json hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="hljs-attr">"presets"</span>: [</span><br><span class="line">       [<span class="hljs-string">"@babel/preset-env"</span>]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>配置loader</strong></p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-built_in">module</span>: &#123;</span><br><span class="line">	rules: [&#123; <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">"babel-loader"</span> &#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>现在打包已经可以成功的将es6语法转化成es5语法！</p>
<h3 id="4-2-解析装饰器"><a href="#4-2-解析装饰器" class="headerlink" title="4.2 解析装饰器"></a>4.2 解析装饰器</h3><figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @babel/plugin-proposal-class-properties @babel/plugin-proposal-decorators --save-dev</span><br></pre></td></tr></table></figure>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"plugins": [</span><br><span class="line">  ["@babel/plugin-proposal-decorators", &#123; "legacy": true &#125;],</span><br><span class="line">  [<span class="hljs-string">"@babel/plugin-proposal-class-properties"</span>,&#123;<span class="hljs-attr">"loose"</span>:<span class="hljs-literal">true</span>&#125;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><code>legacy:true</code>表示继续使用装饰器装饰器，loose为false时会采用<code>Object.defineProperty</code>定义属性</p>
<ul>
<li>Plugin会运行在Preset之前</li>
<li>Plugin 会从第一个开始顺序执行，Preset则是相反的</li>
</ul>
<h3 id="4-3-polyfill"><a href="#4-3-polyfill" class="headerlink" title="4.3 polyfill"></a>4.3 polyfill</h3><p>根据<code>.browserslistrc</code>文件，转化使用到的浏览器api</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-string">"presets"</span>: [</span><br><span class="line">    [<span class="hljs-string">"@babel/preset-env"</span>,&#123;</span><br><span class="line">        <span class="hljs-string">"useBuiltIns"</span>:<span class="hljs-string">"usage"</span>, <span class="hljs-comment">// 按需加载</span></span><br><span class="line">        <span class="hljs-string">"corejs"</span>:<span class="hljs-number">2</span> <span class="hljs-comment">// corejs 替代了以前的pollyfill</span></span><br><span class="line">    &#125;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>安装corejs</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install core-js@2 --save</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>使用<code>transform-runtime</code></strong><br>A plugin that enables the re-use of Babel’s injected helper code to save on codesize.可以帮我们节省代码</p>
</blockquote>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/plugin-transform-runtime @babel/runtime</span><br></pre></td></tr></table></figure>
<p>在<code>.babelrc</code>中配置插件</p>
<figure class="highlight hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"plugins": [</span><br><span class="line">    <span class="hljs-string">"@babel/plugin-transform-runtime"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="4-4-添加eslint"><a href="#4-4-添加eslint" class="headerlink" title="4.4 添加eslint"></a>4.4 添加eslint</h3><p>安装<code>eslint</code></p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install eslint</span><br><span class="line">npx eslint --init <span class="hljs-comment"># 初始化配置文件</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test:/\.js/,</span><br><span class="line">    enforce:&apos;pre&apos;,</span><br><span class="line">    use:&apos;eslint-loader&apos;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<blockquote>
<p>配置<code>eslint-loader</code>可以实时校验js文件的正确性,<code>pre</code>表示在所有<code>loader</code>执行前执行</p>
</blockquote>
<h2 id="5-source-map"><a href="#5-source-map" class="headerlink" title="5.source-map"></a>5.source-map</h2><ul>
<li>eval 生成代码 每个模块都被eval执行,每一个打包后的模块后面都增加了包含sourceURL</li>
<li>source-map 产生map文件</li>
<li>inline 不会生成独立的 .map文件,会以dataURL形式插入</li>
<li>cheap 忽略打包后的列信息，不使用loader中的sourcemap</li>
<li>module 没有列信息，使用loader中的sourcemap(没有列信息)</li>
</ul>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtool:isDev?<span class="hljs-string">'cheap-module-eval-source-map'</span>:<span class="hljs-literal">false</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>每个库中采用的<code>sourcemap</code>方式不一,可以根据自己的需要自行配置</p>
</blockquote>
<h2 id="6-resolve解析"><a href="#6-resolve解析" class="headerlink" title="6.resolve解析"></a>6.resolve解析</h2><p>想实现使用require或是import的时候,可以自动尝试添加扩展名进行匹配</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">resolve: &#123;</span><br><span class="line">    extensions: [<span class="hljs-string">".js"</span>, <span class="hljs-string">".jsx"</span>, <span class="hljs-string">".json"</span>, <span class="hljs-string">".css"</span>, <span class="hljs-string">".ts"</span>, <span class="hljs-string">".tsx"</span>, <span class="hljs-string">".vue"</span>]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="7-拷贝静态文件"><a href="#7-拷贝静态文件" class="headerlink" title="7.拷贝静态文件"></a>7.拷贝静态文件</h2><p>有些时候在打包时希望将一些静态资源文件进行拷贝,可以使用<code>copy-webpack-plugin</code></p>
<p>安装插件</p>
<figure class="highlight bash hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i copy-webpack-plugin --save-dev</span><br></pre></td></tr></table></figure>
<p>使用拷贝插件</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> CopyWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'copy-webpack-plugin'</span>);</span><br><span class="line"><span class="hljs-keyword">new</span> CopyWebpackPlugin([</span><br><span class="line">    &#123;<span class="hljs-attr">from</span>:path.resolve(<span class="hljs-string">'./src/static'</span>),<span class="hljs-attr">to</span>:path.resolve(<span class="hljs-string">'./dist'</span>)&#125;,</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h2 id="8-配置代理"><a href="#8-配置代理" class="headerlink" title="8.配置代理"></a>8.配置代理</h2><p>设置服务端接口</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);</span><br><span class="line"><span class="hljs-keyword">const</span> app = express();</span><br><span class="line">app.get(<span class="hljs-string">'/api/list'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  res.send([<span class="hljs-string">'香蕉'</span>, <span class="hljs-string">'苹果'</span>, <span class="hljs-string">'橘子'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(<span class="hljs-number">4000</span>);</span><br></pre></td></tr></table></figure>
<p>安装<code>axios</code>获取数据</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios --save-dev</span><br></pre></td></tr></table></figure>
<p>配置接口请求</p>
<figure class="highlight html hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(todo,index) in todos"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>&gt;</span></span><br><span class="line">            &#123;&#123;todo&#125;&#125;</span><br><span class="line">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="line"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="hljs-undefined"></span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;</span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">import</span> &#123;Component ,Vue&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-property-decorator'</span>;</span></span><br><span class="line"><span class="hljs-undefined">@Component</span></span><br><span class="line"><span class="hljs-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Todo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Vue</span></span>&#123;</span></span><br><span class="line"><span class="hljs-undefined">    public todos:string[] =[];</span></span><br><span class="line"><span class="hljs-javascript">    <span class="hljs-keyword">async</span> mounted()&#123;</span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">let</span> &#123; data &#125; =  <span class="hljs-keyword">await</span> axios.get(<span class="hljs-string">'/api/list'</span>);</span></span><br><span class="line"><span class="hljs-javascript">        <span class="hljs-keyword">this</span>.todos = data</span></span><br><span class="line"><span class="hljs-undefined">    &#125;</span></span><br><span class="line"><span class="hljs-undefined">&#125;</span></span><br><span class="line"><span class="hljs-undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>配置服务器代理路由</p>
<figure class="highlight javascript hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">proxy: &#123;</span><br><span class="line">    <span class="hljs-string">'/api'</span>: &#123;</span><br><span class="line">    target: <span class="hljs-string">'http://localhost:4000'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

            

            <!--%- index && post.excerpt ? post.excerpt : post.content %-->
        </div>

        
            <ul class="post-copyright">
                <li><strong>本文标题：</strong><a href="http://leechar.github.io/2019/11/02/搭建 webpack 配置/">搭建 webpack 配置</a></li>
                <li><strong>本文作者：</strong><a href="http://leechar.github.io">LeeChar</a></li>
                <li><strong>本文链接：</strong><a href="http://leechar.github.io/2019/11/02/搭建 webpack 配置/">http://leechar.github.io/2019/11/02/搭建 webpack 配置/</a></li>
                <li><strong>发布时间：</strong>2019-11-02</li>
                <li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
                </li>
            </ul>
        


        
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <span class="is-size-6 has-text-grey has-mr-7">#</span>
                    <a class="has-link-grey -link" href="/tags/webpack/">webpack</a>
                </div>
            </div>
        </div>
        
        

        <!--% if (!index && has_config('share.type')) { %-->
<!--        % if (index && has_config('share.type')) { %-->
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2019/11/02/TypeScript 环境/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">TypeScript 环境</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2019/11/02/webpack 优化/">
                <span class="level-item">webpack 优化</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">评论</h3>
        
<div id="valine-thread" class="content"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/js/Valine.min.js"></script>
<!--<script src='//unpkg.com/valine/dist/Valine.min.js'></script>-->
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: false,
        verify: false,
        app_id: 'vMVjrNSKWCIjsMarRg8fhVkX-gzGzoHsz',
        app_key: 'F8VTM12DhQYakS0ciwVdfVgz',
        placeholder: 'Just go go, 支持Markdown~'
    });

</script>

    </div>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    
                    <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="李昌南" style="border-radius: 50%">
                    
                    
                    <p class="is-size-4 is-block">
                        李昌南
                    </p>
                    
                    
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        6
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        1
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        5
                    </p>
                </div>
            </div>
        </nav>
        
        

        
        
    </div>
</div>
    
        
<!--<div class="card widget" id="toc">-->
<div class="card widget column-left is-sticky" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                文章目录
            </h3>
            <ul class="menu-list"><ul class="menu-list"><li>
        <a class="is-flex" href="#1-什么是Webpack？">
        <span class="has-mr-6">1.1</span>
        <span>1.什么是Webpack？</span>
        </a></li><li>
        <a class="is-flex" href="#2-初始化项目">
        <span class="has-mr-6">1.2</span>
        <span>2.初始化项目</span>
        </a></li><li>
        <a class="is-flex" href="#3-webpack快速上手">
        <span class="has-mr-6">1.3</span>
        <span>3.webpack快速上手</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-1-安装">
        <span class="has-mr-6">1.3.1</span>
        <span>3.1 安装</span>
        </a></li><li>
        <a class="is-flex" href="#3-2-webpack-config-js">
        <span class="has-mr-6">1.3.2</span>
        <span>3.2 webpack.config.js</span>
        </a></li><li>
        <a class="is-flex" href="#3-3-配置打包的mode">
        <span class="has-mr-6">1.3.3</span>
        <span>3.3 配置打包的mode</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#4-webpack-dev-server">
        <span class="has-mr-6">1.4</span>
        <span>4.webpack-dev-server</span>
        </a></li><li>
        <a class="is-flex" href="#5-打包Html插件">
        <span class="has-mr-6">1.5</span>
        <span>5.打包Html插件</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#5-1-单入口打包">
        <span class="has-mr-6">1.5.1</span>
        <span>5.1 单入口打包</span>
        </a></li><li>
        <a class="is-flex" href="#5-2-多入口打包">
        <span class="has-mr-6">1.5.2</span>
        <span>5.2 多入口打包</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#6-清空打包结果">
        <span class="has-mr-6">1.6</span>
        <span>6.清空打包结果</span>
        </a></li></ul><li>
        <a class="is-flex" href="#Webpack中必须掌握的配置">
        <span class="has-mr-6">2</span>
        <span>Webpack中必须掌握的配置</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-配置-loader">
        <span class="has-mr-6">2.1</span>
        <span>1.配置 loader</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#1-1-loader的使用">
        <span class="has-mr-6">2.1.1</span>
        <span>1.1 loader的使用</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#2-处理CSS文件">
        <span class="has-mr-6">2.2</span>
        <span>2.处理CSS文件</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#2-1-解析css样式">
        <span class="has-mr-6">2.2.1</span>
        <span>2.1 解析css样式</span>
        </a></li><li>
        <a class="is-flex" href="#2-2-抽离样式文件">
        <span class="has-mr-6">2.2.2</span>
        <span>2.2 抽离样式文件</span>
        </a></li><li>
        <a class="is-flex" href="#2-3-css预处理器">
        <span class="has-mr-6">2.2.3</span>
        <span>2.3 css预处理器</span>
        </a></li><li>
        <a class="is-flex" href="#2-4-处理样式前缀">
        <span class="has-mr-6">2.2.4</span>
        <span>2.4 处理样式前缀</span>
        </a></li><li>
        <a class="is-flex" href="#2-5-css压缩">
        <span class="has-mr-6">2.2.5</span>
        <span>2.5 css压缩</span>
        </a></li><li>
        <a class="is-flex" href="#2-6-文件指纹">
        <span class="has-mr-6">2.2.6</span>
        <span>2.6 文件指纹</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#3-处理文件类型">
        <span class="has-mr-6">2.3</span>
        <span>3.处理文件类型</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#3-1-处理引用的图片">
        <span class="has-mr-6">2.3.1</span>
        <span>3.1 处理引用的图片</span>
        </a></li><li>
        <a class="is-flex" href="#3-2-处理icon">
        <span class="has-mr-6">2.3.2</span>
        <span>3.2 处理icon</span>
        </a></li><li>
        <a class="is-flex" href="#3-3-转化成base64">
        <span class="has-mr-6">2.3.3</span>
        <span>3.3 转化成base64</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#4-处理JS模块">
        <span class="has-mr-6">2.4</span>
        <span>4.处理JS模块</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#4-1-将es6代码编译成es5代码">
        <span class="has-mr-6">2.4.1</span>
        <span>4.1 将es6代码编译成es5代码</span>
        </a></li><li>
        <a class="is-flex" href="#4-2-解析装饰器">
        <span class="has-mr-6">2.4.2</span>
        <span>4.2 解析装饰器</span>
        </a></li><li>
        <a class="is-flex" href="#4-3-polyfill">
        <span class="has-mr-6">2.4.3</span>
        <span>4.3 polyfill</span>
        </a></li><li>
        <a class="is-flex" href="#4-4-添加eslint">
        <span class="has-mr-6">2.4.4</span>
        <span>4.4 添加eslint</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#5-source-map">
        <span class="has-mr-6">2.5</span>
        <span>5.source-map</span>
        </a></li><li>
        <a class="is-flex" href="#6-resolve解析">
        <span class="has-mr-6">2.6</span>
        <span>6.resolve解析</span>
        </a></li><li>
        <a class="is-flex" href="#7-拷贝静态文件">
        <span class="has-mr-6">2.7</span>
        <span>7.拷贝静态文件</span>
        </a></li><li>
        <a class="is-flex" href="#8-配置代理">
        <span class="has-mr-6">2.8</span>
        <span>8.配置代理</span>
        </a></li></ul></li></ul>
        </div>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen is-sticky">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    云卷云舒
                
                </a>
                <p class="is-size-7">
                &copy; 2016—2019 LeeChar&nbsp;
                由<a href="http://hexo.io/" target="_blank">Hexo</a> 强力驱动
                    <!--& <a href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>-->
                
                <br>
                <span id="busuanzi_container_site_uv">
                您是第<span id="busuanzi_value_site_uv">0</span>个访客
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="全文搜索站内文章~">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    

    <!--背景线条-->
    <!--<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-1" count="99" src="dist/canvas-nest.js"></script>-->
    <!--<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-1" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>-->
</body>
</html>